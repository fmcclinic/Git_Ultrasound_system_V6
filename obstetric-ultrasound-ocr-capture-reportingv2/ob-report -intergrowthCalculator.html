<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Obstetric Ultrasound Report / Báo cáo Siêu âm Sản khoa</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>
<body class="ocr-feature-disabled video-capture-disabled"> <div class="container">
        <h1>Obstetric Ultrasound Reporting System / Hệ thống tạo báo cáo Siêu âm Sản khoa</h1>

        <div class="tab-container">
            <div class="tab-nav">
                <button class="tab-button active" data-tab="patient-info">Patient Info / Thông tin BN</button>
                <button class="tab-button" data-tab="ob-assessment">Obstetric Assessment / Khảo sát Sản khoa</button>
                <button class="tab-button" data-tab="images">Images / Hình ảnh</button>
                <button class="tab-button" data-tab="templates">Templates / Mẫu</button>
                <button class="tab-button" data-tab="report">Report / Báo cáo</button>
            </div>

            <div class="tab-content active" id="patient-info">
                 <h2>Patient Information / Thông tin Bệnh nhân</h2>
                 <form id="patient-info-form">
                    <div class="form-group">
                        <label for="patient-name">Họ và Tên / Full Name:</label>
                        <input type="text" id="patient-name" name="patientName" required>
                    </div>
                    <div class="form-group">
                        <label for="patient-id">Mã BN / Patient ID:</label>
                        <input type="text" id="patient-id" name="patientId" required>
                    </div>
                     <div class="form-group">
                        <label for="patient-dob">Ngày sinh / Date of Birth:</label>
                        <input type="date" id="patient-dob" name="patientDob">
                    </div>
                    <div class="form-group">
                        <label for="requesting-physician">Bác sĩ chỉ định / Requesting Physician:</label>
                        <input type="text" id="requesting-physician" name="requestingPhysician">
                    </div>
                    <div class="form-group">
                        <label for="exam-date">Ngày siêu âm / Exam Date:</label>
                        <input type="date" id="exam-date" name="examDate" value=""> </div>
                    <div class="form-group">
                        <label for="reason">Reason for Exam / Clinical Info / Lý do khám / LS:</label>
                        <input type="text" id="reason" name="reason" list="reason-suggestions-ob" placeholder="Enter reason or select from list... / Nhập lý do hoặc chọn từ danh sách...">
                        <datalist id="reason-suggestions-ob">
                            <option value="Dating scan / Xác định tuổi thai"></option>
                            <option value="Anatomy scan / Khảo sát hình thái"></option>
                            <option value="Growth scan / Đánh giá tăng trưởng"></option>
                            <option value="Nuchal translucency / Độ mờ da gáy"></option>
                            <option value="Decreased fetal movement / Thai cử động yếu"></option>
                            <option value="Bleeding / Ra huyết"></option>
                            <option value="Follow-up anomaly / Theo dõi bất thường"></option>
                            <option value="Follow-up growth / Theo dõi tăng trưởng"></option>
                            <option value="Follow-up placenta / Theo dõi nhau thai"></option>
                            <option value="Cervical length assessment / Đánh giá chiều dài CTC"></option>
                            <option value="Rule out ectopic pregnancy / Loại trừ thai ngoài tử cung"></option>
                            <option value="Pain / Đau bụng"></option>
                        </datalist>
                    </div>
                     <div class="form-group">
                        <label for="reporting-doctor">Reporting Doctor / Bác sĩ siêu âm:</label>
                        <input type="text" id="reporting-doctor" name="reportingDoctor" placeholder="Enter reporting doctor's name / Nhập tên BS đọc KQ">
                    </div>
                </form>
            </div>

            <div class="tab-content" id="ob-assessment">
                <h2>Obstetric Assessment / Khảo sát Sản khoa</h2>
                <form id="ob-assessment-form">

                    <details class="section organ-section" open>
                        <summary class="section-toggle"><h3><i class="fas fa-calendar-alt"></i> Gestational Information / Thông tin Thai kỳ</h3></summary>
                        <div class="section-content">
                            <div class="form-grid-col-3">
                                <div class="form-group"> <label for="lmp">LMP / Kinh chót:</label> <input type="date" id="lmp" name="lmp"> </div>
                                <div class="form-group"> <label for="ga-lmp">GA by LMP / Tuổi thai theo KCC:</label> <input type="text" id="ga-lmp" name="gaLmp" placeholder="e.g., 12w3d / vd: 12t3n" class="calculated-value" readonly> </div>
                                <div class="form-group"> <label for="edd-lmp">EDD by LMP / Ngày dự sinh theo KCC:</label> <input type="date" id="edd-lmp" name="eddLmp" class="calculated-value" readonly> </div>
                                <div class="form-group"> <label for="ga-us">GA by Ultrasound / Tuổi thai theo SA:</label> <input type="text" id="ga-us" name="gaUs" placeholder="e.g., 20w1d / vd: 20t1n" class="calculated-value"> </div>
                                <div class="form-group"> <label for="edd-us">EDD by Ultrasound / Ngày dự sinh theo SA:</label> <input type="date" id="edd-us" name="eddUs" class="calculated-value"> </div>
                                <div class="form-group"> <label for="ultrasound-method">Method / Phương pháp SA:</label> <select id="ultrasound-method" name="ultrasoundMethod"> <option value="Transabdominal / Ngã bụng">Transabdominal / Ngã bụng</option> <option value="Transvaginal / Ngã âm đạo">Transvaginal / Ngã âm đạo</option> <option value="Combined / Kết hợp">Combined / Kết hợp</option> </select> </div>
                            </div>
                        </div>
                    </details>

                    <details class="section organ-section">
                        <summary class="section-toggle"><h3><i class="fas fa-ruler-combined"></i> Fetal Biometry / Sinh trắc học Thai</h3></summary>
                        <div class="section-content">
                            <div class="fetal-biometry-section">
                                <div class="fetus-entry" data-fetus-number="1">
                                    <h4>Fetus 1 / Thai 1</h4>
                                    <div class="form-grid-col-4">
                                        <div class="form-group">
                                            <label for="crl_1">CRL (mm):</label>
                                            <input type="number" step="0.1" id="crl_1" name="crl_1" placeholder="mm" class="biometry-input">
                                            </div>
                                        <div class="form-group">
                                            <label for="bpd_1">BPD (mm) / ĐK Lưỡng đỉnh:</label>
                                            <input type="number" step="0.1" id="bpd_1" name="bpd" placeholder="mm" class="biometry-input">
                                            <small class="percentile-display" id="bpd_1_percentile">--</small>
                                            <i class="fas fa-info-circle percentile-info-icon" title="Tiêu chuẩn INTERGROWTH-21st / INTERGROWTH-21st Standard"></i>
                                        </div>
                                        <div class="form-group">
                                            <label for="hc_1">HC (mm) / Chu vi đầu:</label>
                                            <input type="number" step="0.1" id="hc_1" name="hc" placeholder="mm" class="biometry-input">
                                            <small class="percentile-display" id="hc_1_percentile">--</small>
                                             <i class="fas fa-info-circle percentile-info-icon" title="Tiêu chuẩn INTERGROWTH-21st / INTERGROWTH-21st Standard"></i>
                                        </div>
                                        <div class="form-group">
                                            <label for="ac_1">AC (mm) / Chu vi bụng:</label>
                                            <input type="number" step="0.1" id="ac_1" name="ac" placeholder="mm" class="biometry-input">
                                            <small class="percentile-display" id="ac_1_percentile">--</small>
                                             <i class="fas fa-info-circle percentile-info-icon" title="Tiêu chuẩn INTERGROWTH-21st / INTERGROWTH-21st Standard"></i>
                                        </div>
                                        <div class="form-group">
                                            <label for="fl_1">FL (mm) / Chiều dài XĐ:</label>
                                            <input type="number" step="0.1" id="fl_1" name="fl" placeholder="mm" class="biometry-input">
                                            <small class="percentile-display" id="fl_1_percentile">--</small>
                                             <i class="fas fa-info-circle percentile-info-icon" title="Tiêu chuẩn INTERGROWTH-21st / INTERGROWTH-21st Standard"></i>
                                        </div>
                                        <div class="form-group">
                                            <label for="hl_1">HL (mm) / Chiều dài XC Tay:</label>
                                            <input type="number" step="0.1" id="hl_1" name="hl" placeholder="mm" class="biometry-input">
                                            <small class="percentile-display" id="hl_1_percentile">--</small>
                                             <i class="fas fa-info-circle percentile-info-icon" title="Tiêu chuẩn INTERGROWTH-21st / INTERGROWTH-21st Standard (Nếu có)"></i>
                                        </div>
                                        <div class="form-group">
                                            <label for="efw-method_1">EFW Method / Công thức ULCN:</label>
                                            <select id="efw-method_1" name="efwMethod_1"> <option value="">-- Select / Chọn --</option> <option value="Hadlock (BPD,HC,AC,FL)">Hadlock (BPD,HC,AC,FL)</option> <option value="Shepard (BPD,AC)">Shepard (BPD,AC)</option> <option value="INTERGROWTH-21st (HC,AC,FL)">INTERGROWTH-21st (HC,AC,FL)</option></select>
                                        </div>
                                        <div class="form-group">
                                            <label for="efw_1">EFW (g) / ƯLCN (gram):</label>
                                            <input type="number" id="efw_1" name="efw_1" placeholder="g / gram" class="calculated-value">
                                        </div>
                                        <div class="form-group">
                                            <label for="efw-percentile_1">EFW Percentile / Bách phân vị ULCN (%):</label>
                                            <input type="number" step="0.1" id="efw-percentile_1" name="efwPercentile_1" placeholder="%" class="calculated-value">
                                        </div>
                                    </div>
                                </div>
                                </div>
                        </div>
                    </details>

                    <details class="section organ-section">
                         <summary class="section-toggle"><h3><i class="fas fa-baby"></i> Fetal Anatomy Survey / Khảo sát Hình thái học Thai</h3></summary>
                         <div class="section-content">
                            <div class="form-grid-col-2">
                                <details class="anatomy-subsection"> <summary>Head/Brain / Đầu/Não</summary> <div class="anatomy-content"> <div class="form-group"> <label for="anatomyHeadStatus">Status / Tình trạng:</label> <select id="anatomyHeadStatus" name="anatomyHeadStatus" class="anatomy-status-select" data-target-area="anatomy_head_desc"> <option value="Normal / Bình thường">Normal / Bình thường</option> <option value="Abnormal / Bất thường">Abnormal / Bất thường</option> <option value="Not Visualized / Không thấy rõ">Not Visualized / Không thấy rõ</option> </select> </div> <div class="form-group anatomy-description-group" style="display: none;"> <label for="anatomy_head_desc">Description / Mô tả Bất thường:</label> <textarea id="anatomy_head_desc" name="anatomyHeadDesc" rows="3" placeholder="Describe abnormality..."></textarea> <div class="suggestion-button-container"> <button type="button" class="suggestion-btn" data-insert="Ventriculomegaly / Giãn não thất ([measurement] mm)">Ventriculomegaly</button> <button type="button" class="suggestion-btn" data-insert="Choroid plexus cyst / Nang đám rối mạch mạc ([size] mm)">CPC</button> <button type="button" class="suggestion-btn" data-insert="Holoprosencephaly / Não thất duy nhất ([type])">Holoprosencephaly</button> <button type="button" class="suggestion-btn" data-insert="Agenesis of corpus callosum / Bất sản thể chai">ACC</button> <button type="button" class="suggestion-btn" data-insert="Cerebellar hypoplasia / Thiểu sản tiểu não">Cerebellar Hypoplasia</button> <button type="button" class="suggestion-btn" data-insert="Dandy-Walker malformation / Dị tật Dandy-Walker">Dandy-Walker</button> <button type="button" class="suggestion-btn" data-insert="Anencephaly / Thai vô sọ">Anencephaly</button> <button type="button" class="suggestion-btn" data-insert="Microcephaly / Đầu nhỏ">Microcephaly</button> </div> </div> </div> </details>
                                <details class="anatomy-subsection"> <summary>Face / Mặt</summary> <div class="anatomy-content"> <div class="form-group"> <label for="anatomyFaceStatus">Status / Tình trạng:</label> <select id="anatomyFaceStatus" name="anatomyFaceStatus" class="anatomy-status-select" data-target-area="anatomy_face_desc"> <option value="Normal / Bình thường">Normal / Bình thường</option> <option value="Abnormal / Bất thường">Abnormal / Bất thường</option> <option value="Not Visualized / Không thấy rõ">Not Visualized / Không thấy rõ</option> </select> </div> <div class="form-group anatomy-description-group" style="display: none;"> <label for="anatomy_face_desc">Description / Mô tả Bất thường:</label> <textarea id="anatomy_face_desc" name="anatomyFaceDesc" rows="3" placeholder="Describe abnormality..."></textarea> <div class="suggestion-button-container"> <button type="button" class="suggestion-btn" data-insert="Cleft lip/palate ([unilateral/bilateral], [complete/incomplete]) / Sứt môi/hở hàm ếch ([một bên/hai bên], [toàn phần/không toàn phần])">Cleft Lip/Palate</button> <button type="button" class="suggestion-btn" data-insert="Micrognathia / Cằm nhỏ">Micrognathia</button> <button type="button" class="suggestion-btn" data-insert="Hypertelorism / Hai mắt xa nhau">Hypertelorism</button> <button type="button" class="suggestion-btn" data-insert="Hypotelorism / Hai mắt gần nhau">Hypotelorism</button> <button type="button" class="suggestion-btn" data-insert="Nasal bone absent/hypoplastic / Bất sản/thiểu sản xương mũi">Nasal Bone</button> <button type="button" class="suggestion-btn" data-insert="Proboscis / Vòi">Proboscis</button> </div> </div> </div> </details>
                                <details class="anatomy-subsection"> <summary>Neck / Cổ</summary> <div class="anatomy-content"> <div class="form-group"> <label for="anatomyNeckStatus">Status / Tình trạng:</label> <select id="anatomyNeckStatus" name="anatomyNeckStatus" class="anatomy-status-select" data-target-area="anatomy_neck_desc"> <option value="Normal / Bình thường">Normal / Bình thường</option> <option value="Abnormal / Bất thường">Abnormal / Bất thường</option> <option value="Not Visualized / Không thấy rõ">Not Visualized / Không thấy rõ</option> </select> </div> <div class="form-group anatomy-description-group" style="display: none;"> <label for="anatomy_neck_desc">Description / Mô tả Bất thường:</label> <textarea id="anatomy_neck_desc" name="anatomyNeckDesc" rows="3" placeholder="Describe abnormality..."></textarea> <div class="suggestion-button-container"> <button type="button" class="suggestion-btn" data-insert="Increased nuchal translucency / Tăng độ mờ da gáy ([measurement] mm)">Increased NT</button> <button type="button" class="suggestion-btn" data-insert="Increased nuchal fold / Dày da gáy ([measurement] mm)">Increased Nuchal Fold</button> <button type="button" class="suggestion-btn" data-insert="Cystic hygroma / Nang bạch huyết vùng cổ ([size], [septated/non-septated])">Cystic Hygroma</button> <button type="button" class="suggestion-btn" data-insert="Nuchal cord (x[number]) / Dây rốn quấn cổ (x[số vòng])">Nuchal Cord</button> </div> </div> </div> </details>
                                <details class="anatomy-subsection"> <summary>Chest/Heart / Ngực/Tim</summary> <div class="anatomy-content"> <div class="form-group"> <label for="anatomyChestStatus">Status / Tình trạng:</label> <select id="anatomyChestStatus" name="anatomyChestStatus" class="anatomy-status-select" data-target-area="anatomy_chest_desc"> <option value="Normal / Bình thường">Normal / Bình thường</option> <option value="Abnormal / Bất thường">Abnormal / Bất thường</option> <option value="Not Visualized / Không thấy rõ">Not Visualized / Không thấy rõ</option> </select> </div> <div class="form-group anatomy-description-group" style="display: none;"> <label for="anatomy_chest_desc">Description / Mô tả Bất thường:</label> <textarea id="anatomy_chest_desc" name="anatomyChestDesc" rows="3" placeholder="Describe abnormality..."></textarea> <div class="suggestion-button-container"> <button type="button" class="suggestion-btn" data-insert="Cardiac defect suspected ([VSD/ASD/TOF/HLHS/...]) / Nghi ngờ tim bẩm sinh ([VSD/ASD/TOF/HLHS/...])">Cardiac Defect</button> <button type="button" class="suggestion-btn" data-insert="Echogenic intracardiac focus (EIF) / Nốt phản âm sáng trong tim ([left/right/bilateral ventricle])">EIF</button> <button type="button" class="suggestion-btn" data-insert="Cardiomegaly / Tim to">Cardiomegaly</button> <button type="button" class="suggestion-btn" data-insert="Pleural effusion / Tràn dịch màng phổi ([unilateral/bilateral])">Pleural Effusion</button> <button type="button" class="suggestion-btn" data-insert="Congenital Pulmonary Airway Malformation (CPAM) / Dị dạng đường thở phổi bẩm sinh">CPAM</button> <button type="button" class="suggestion-btn" data-insert="Congenital Diaphragmatic Hernia (CDH) / Thoát vị hoành bẩm sinh">CDH</button> </div> </div> </div> </details>
                                <details class="anatomy-subsection"> <summary>Abdomen / Bụng</summary> <div class="anatomy-content"> <div class="form-group"> <label for="anatomyAbdomenStatus">Status / Tình trạng:</label> <select id="anatomyAbdomenStatus" name="anatomyAbdomenStatus" class="anatomy-status-select" data-target-area="anatomy_abdomen_desc"> <option value="Normal / Bình thường">Normal / Bình thường</option> <option value="Abnormal / Bất thường">Abnormal / Bất thường</option> <option value="Not Visualized / Không thấy rõ">Not Visualized / Không thấy rõ</option> </select> </div> <div class="form-group anatomy-description-group" style="display: none;"> <label for="anatomy_abdomen_desc">Description / Mô tả Bất thường:</label> <textarea id="anatomy_abdomen_desc" name="anatomyAbdomenDesc" rows="3" placeholder="Describe abnormality..."></textarea> <div class="suggestion-button-container"> <button type="button" class="suggestion-btn" data-insert="Gastroschisis / Hở thành bụng">Gastroschisis</button> <button type="button" class="suggestion-btn" data-insert="Omphalocele / Thoát vị rốn (chứa [liver/bowel])">Omphalocele</button> <button type="button" class="suggestion-btn" data-insert="Echogenic bowel / Ruột tăng âm">Echogenic Bowel</button> <button type="button" class="suggestion-btn" data-insert="Duodenal atresia ("double bubble") / Tắc tá tràng ("dấu hiệu bóng đôi")">Duodenal Atresia</button> <button type="button" class="suggestion-btn" data-insert="Ascites / Báng bụng">Ascites</button> <button type="button" class="suggestion-btn" data-insert="Pyelectasis / Giãn bể thận ([measurement] mm, [unilateral/bilateral])">Pyelectasis</button> <button type="button" class="suggestion-btn" data-insert="Hydronephrosis / Ứ nước thận ([grade], [unilateral/bilateral])">Hydronephrosis</button> <button type="button" class="suggestion-btn" data-insert="Multicystic dysplastic kidney (MCDK) / Loạn sản thận đa nang">MCDK</button> <button type="button" class="suggestion-btn" data-insert="Renal agenesis / Bất sản thận ([unilateral/bilateral])">Renal Agenesis</button> </div> </div> </div> </details>
                                <details class="anatomy-subsection"> <summary>Spine / Cột sống</summary> <div class="anatomy-content"> <div class="form-group"> <label for="anatomySpineStatus">Status / Tình trạng:</label> <select id="anatomySpineStatus" name="anatomySpineStatus" class="anatomy-status-select" data-target-area="anatomy_spine_desc"> <option value="Normal / Bình thường">Normal / Bình thường</option> <option value="Abnormal / Bất thường">Abnormal / Bất thường</option> <option value="Not Visualized / Không thấy rõ">Not Visualized / Không thấy rõ</option> </select> </div> <div class="form-group anatomy-description-group" style="display: none;"> <label for="anatomy_spine_desc">Description / Mô tả Bất thường:</label> <textarea id="anatomy_spine_desc" name="anatomySpineDesc" rows="3" placeholder="Describe abnormality..."></textarea> <div class="suggestion-button-container"> <button type="button" class="suggestion-btn" data-insert="Spina bifida / Nứt đốt sống ([level], [open/closed], [meningocele/myelomeningocele])">Spina Bifida</button> <button type="button" class="suggestion-btn" data-insert="Scoliosis / Vẹo cột sống">Scoliosis</button> <button type="button" class="suggestion-btn" data-insert="Hemivertebra / Tật nửa đốt sống">Hemivertebra</button> <button type="button" class="suggestion-btn" data-insert="Sacral agenesis / Bất sản xương cùng">Sacral Agenesis</button> </div> </div> </div> </details>
                                <details class="anatomy-subsection"> <summary>Limbs / Tứ chi</summary> <div class="anatomy-content"> <div class="form-group"> <label for="anatomyLimbsStatus">Status / Tình trạng:</label> <select id="anatomyLimbsStatus" name="anatomyLimbsStatus" class="anatomy-status-select" data-target-area="anatomy_limbs_desc"> <option value="Normal / Bình thường">Normal / Bình thường</option> <option value="Abnormal / Bất thường">Abnormal / Bất thường</option> <option value="Not Visualized / Không thấy rõ">Not Visualized / Không thấy rõ</option> </select> </div> <div class="form-group anatomy-description-group" style="display: none;"> <label for="anatomy_limbs_desc">Description / Mô tả Bất thường:</label> <textarea id="anatomy_limbs_desc" name="anatomyLimbsDesc" rows="3" placeholder="Describe abnormality..."></textarea> <div class="suggestion-button-container"> <button type="button" class="suggestion-btn" data-insert="Clubfoot / Chân khoèo ([unilateral/bilateral])">Clubfoot</button> <button type="button" class="suggestion-btn" data-insert="Short limbs / Chi ngắn (suspected skeletal dysplasia / nghi ngờ loạn sản xương)">Short Limbs</button> <button type="button" class="suggestion-btn" data-insert="Polydactyly / Thừa ngón">Polydactyly</button> <button type="button" class="suggestion-btn" data-insert="Clinodactyly / Ngón tay cong">Clinodactyly</button> <button type="button" class="suggestion-btn" data-insert="Limb reduction defect / Khuyết tật giảm chi">Limb Reduction</button> <button type="button" class="suggestion-btn" data-insert="Sandal gap foot / Bàn chân có khoảng cách rộng giữa ngón I và II">Sandal Gap</button> </div> </div> </div> </details>
                                <details class="anatomy-subsection"> <summary>Genitalia / Bộ phận sinh dục</summary> <div class="anatomy-content"> <div class="form-group"> <label for="anatomyGenitaliaStatus">Status / Tình trạng:</label> <select id="anatomyGenitaliaStatus" name="anatomyGenitaliaStatus" class="anatomy-status-select" data-target-area="anatomy_genitalia_desc"> <option value="Normal Male / Nam bình thường">Normal Male / Nam bình thường</option> <option value="Normal Female / Nữ bình thường">Normal Female / Nữ bình thường</option> <option value="Ambiguous / Không rõ ràng">Ambiguous / Không rõ ràng</option> <option value="Abnormal / Bất thường">Abnormal / Bất thường</option> <option value="Not Visualized / Không thấy rõ">Not Visualized / Không thấy rõ</option> </select> </div> <div class="form-group anatomy-description-group" style="display: none;"> <label for="anatomy_genitalia_desc">Description / Mô tả Bất thường:</label> <textarea id="anatomy_genitalia_desc" name="anatomyGenitaliaDesc" rows="3" placeholder="Describe abnormality..."></textarea> <div class="suggestion-button-container"> <button type="button" class="suggestion-btn" data-insert="Hypospadias / Lỗ tiểu thấp">Hypospadias</button> <button type="button" class="suggestion-btn" data-insert="Undescended testes / Tinh hoàn ẩn">Undescended Testes</button> <button type="button" class="suggestion-btn" data-insert="Hydrocele / Tràn dịch tinh mạc">Hydrocele</button> </div> </div> </div> </details>
                            </div>
                         </div>
                    </details>

                    <details class="section organ-section"> <summary class="section-toggle"><h3><i class="fas fa-water"></i> Amniotic Fluid / Nước ối</h3></summary> <div class="section-content"> <div class="form-grid-col-3"> <div class="form-group"> <label for="afi">AFI (cm) / Chỉ số ối:</label> <input type="number" step="0.1" id="afi" name="afi" placeholder="cm"> </div> <div class="form-group"> <label for="sdp">SDP (cm) / Khoang ối sâu nhất:</label> <input type="number" step="0.1" id="sdp" name="sdp" placeholder="cm"> </div> <div class="form-group"> <label for="fluid-assessment">Qualitative Assessment / Đánh giá định tính:</label> <select id="fluid-assessment" name="fluidAssessment"> <option value="">-- Select / Chọn --</option> <option value="Normal / Bình thường">Normal / Bình thường</option> <option value="Oligohydramnios / Thiểu ối">Oligohydramnios / Thiểu ối</option> <option value="Polyhydramnios / Đa ối">Polyhydramnios / Đa ối</option> <option value="Anhydramnios / Vô ối">Anhydramnios / Vô ối</option> </select> </div> </div> </div> </details>

                    <details class="section organ-section"> <summary class="section-toggle"><h3><i class="fas fa-project-diagram"></i> Placenta / Nhau thai</h3></summary> <div class="section-content"> <div class="form-grid-col-3"> <div class="form-group"> <label for="placentaLocation">Location / Vị trí:</label> <select id="placentaLocation" name="placentaLocation"> <option value="">-- Select / Chọn --</option> <option value="Anterior / Mặt trước">Anterior / Mặt trước</option> <option value="Posterior / Mặt sau">Posterior / Mặt sau</option> <option value="Fundal / Đáy">Fundal / Đáy</option> <option value="Lateral Right / Bên Phải">Lateral Right / Bên Phải</option> <option value="Lateral Left / Bên Trái">Lateral Left / Bên Trái</option> <option value="Low-lying / Bám thấp">Low-lying / Bám thấp</option> <option value="Previa - Marginal / Nhau tiền đạo - Mép">Previa - Marginal / Nhau tiền đạo - Mép</option> <option value="Previa - Partial / Nhau tiền đạo - Bán trung tâm">Previa - Partial / Nhau tiền đạo - Bán trung tâm</option> <option value="Previa - Complete / Nhau tiền đạo - Trung tâm hoàn toàn">Previa - Complete / Nhau tiền đạo - Trung tâm hoàn toàn</option> </select> </div> <div class="form-group"> <label for="placentaDistanceOs">Distance from Os (mm) / Khoảng cách tới lỗ trong CTC:</label> <input type="number" step="1" id="placentaDistanceOs" name="placentaDistanceOs" placeholder="mm (if low/previa)"> </div> <div class="form-group"> <label for="placentaGrade">Grade / Độ trưởng thành:</label> <select id="placentaGrade" name="placentaGrade"> <option value="">-- Select / Chọn --</option> <option value="0">Grade 0</option> <option value="I">Grade I</option> <option value="II">Grade II</option> <option value="III">Grade III</option> </select> </div> </div> <div class="form-group"> <label for="placentaAppearance">Appearance / Hình dạng:</label> <textarea id="placentaAppearance" name="placentaAppearance" rows="3" placeholder="Describe appearance..."></textarea> <div class="suggestion-button-container"> <button type="button" class="suggestion-btn" data-insert="Homogeneous / Đồng nhất">Homogeneous</button> <button type="button" class="suggestion-btn" data-insert="Calcifications present / Có vôi hóa">Calcifications</button> <button type="button" class="suggestion-btn" data-insert="Placental lakes present / Có hồ huyết">Lakes</button> <button type="button" class="suggestion-btn" data-insert="Retroplacental hematoma / Khối máu tụ sau nhau ([size])">Retroplacental Hematoma</button> <button type="button" class="suggestion-btn" data-insert="Marginal separation / Bóc mép bánh nhau">Marginal Separation</button> <button type="button" class="suggestion-btn" data-insert="Succenturiate lobe / Nhau phụ">Succenturiate Lobe</button> <button type="button" class="suggestion-btn" data-insert="Thickened placenta / Bánh nhau dày ([measurement] mm)">Thickened</button> </div> </div> </div> </details>

                    <details class="section organ-section"> <summary class="section-toggle"><h3><i class="fas fa-ring"></i> Cervix / Cổ tử cung</h3></summary> <div class="section-content"> <div class="form-grid-col-3"> <div class="form-group"> <label for="cervixLength">Length (mm) / Chiều dài:</label> <input type="number" step="0.1" id="cervixLength" name="cervixLength" placeholder="mm"> </div> <div class="form-group"> <label for="cervixMethod">Method / Phương pháp đo:</label> <select id="cervixMethod" name="cervixMethod"> <option value="">-- Select / Chọn --</option> <option value="Transabdominal / Ngã bụng">Transabdominal / Ngã bụng</option> <option value="Transvaginal / Ngã âm đạo">Transvaginal / Ngã âm đạo</option> </select> </div> <div class="form-group"> <label for="cervixAppearance">Appearance / Hình dạng:</label> <select id="cervixAppearance" name="cervixAppearance"> <option value="">-- Select / Chọn --</option> <option value="Closed / Đóng">Closed / Đóng</option> <option value="Funneling / Hình phễu">Funneling / Hình phễu</option> <option value="Dilated / Mở">Dilated / Mở ([cm])</option> <option value="Not well visualized / Không thấy rõ">Not well visualized</option> </select> </div> </div> </div> </details>

                     <details class="section organ-section"> <summary class="section-toggle"><h3><i class="fas fa-female"></i> Maternal Structures / Cấu trúc của Mẹ</h3></summary> <div class="section-content"> <div class="form-grid-col-2"> <div class="form-group"> <label for="maternalUterus">Uterus / Tử cung:</label> <textarea id="maternalUterus" name="maternalUterus" rows="3" placeholder="Describe fibroids (location, size), etc."></textarea> <div class="suggestion-button-container"> <button type="button" class="suggestion-btn" data-insert="Normal appearance / Hình dạng bình thường">Normal Uterus</button> <button type="button" class="suggestion-btn" data-insert="Fibroid(s) noted: / Ghi nhận u xơ:">Fibroids Noted</button> <button type="button" class="suggestion-btn" data-insert="Intramural fibroid, [location], [size] mm. / U xơ trong cơ, [vị trí], [kích thước] mm.">Intramural Fibroid</button> <button type="button" class="suggestion-btn" data-insert="Subserosal fibroid, [location], [size] mm. / U xơ dưới thanh mạc, [vị trí], [kích thước] mm.">Subserosal Fibroid</button> <button type="button" class="suggestion-btn" data-insert="Submucosal fibroid, [location], [size] mm. / U xơ dưới niêm mạc, [vị trí], [kích thước] mm.">Submucosal Fibroid</button> </div> </div> <div class="form-group"> <label for="maternalAdnexa">Adnexa (Ovaries) / Phần phụ (Buồng trứng):</label> <textarea id="maternalAdnexa" name="maternalAdnexa" rows="3" placeholder="Describe ovarian cysts (size, characteristics), masses, etc."></textarea> <div class="suggestion-button-container"> <button type="button" class="suggestion-btn" data-insert="Ovaries appear normal bilaterally. / Hai buồng trứng hình dạng bình thường.">Normal Adnexa</button> <button type="button" class="suggestion-btn" data-insert="Right ovarian cyst, [size] mm, simple appearance. / Nang buồng trứng phải, [kích thước] mm, dạng nang đơn giản.">R Simple Cyst</button> <button type="button" class="suggestion-btn" data-insert="Left ovarian cyst, [size] mm, simple appearance. / Nang buồng trứng trái, [kích thước] mm, dạng nang đơn giản.">L Simple Cyst</button> <button type="button" class="suggestion-btn" data-insert="Corpus luteum cyst, [size] mm, [right/left] ovary. / Nang hoàng thể, [kích thước] mm, buồng trứng [phải/trái].">Corpus Luteum</button> <button type="button" class="suggestion-btn" data-insert="Complex adnexal mass, [size] mm, [right/left]. Recommend further evaluation. / Khối phần phụ dạng phức tạp, [kích thước] mm, bên [phải/trái]. Đề nghị khảo sát thêm.">Complex Mass</button> <button type="button" class="suggestion-btn" data-insert="Ovaries not well visualized. / Khó thấy rõ buồng trứng.">Adnexa Not Seen</button> </div> </div> </div> </div> </details>

                    <details class="section organ-section"> <summary class="section-toggle"><h3><i class="fas fa-heartbeat"></i> Fetal Well-being (Optional) / Sức khỏe Thai (Tùy chọn)</h3></summary> <div class="section-content"> <fieldset class="sub-section"> <legend>Biophysical Profile (BPP) / Trắc đồ sinh vật lý</legend> <div class="form-grid-col-5"> <div class="form-group"> <label for="bpp_tone">Tone / Trương lực (2/0):</label> <input type="number" id="bpp_tone" name="bppTone" min="0" max="2" step="2"> </div> <div class="form-group"> <label for="bpp_movement">Movement / Cử động (2/0):</label> <input type="number" id="bpp_movement" name="bppMovement" min="0" max="2" step="2"> </div> <div class="form-group"> <label for="bpp_breathing">Breathing / Nhịp thở (2/0):</label> <input type="number" id="bpp_breathing" name="bppBreathing" min="0" max="2" step="2"> </div> <div class="form-group"> <label for="bpp_fluid">Fluid / Nước ối (2/0):</label> <input type="number" id="bpp_fluid" name="bppFluid" min="0" max="2" step="2"> </div> <div class="form-group"> <label for="bpp_score">Total Score / Tổng điểm (/8):</label> <input type="number" id="bpp_score" name="bppScore" class="calculated-value" readonly> </div> </div> </fieldset> <fieldset class="sub-section" style="margin-top: 15px;"> <legend>Doppler Indices / Chỉ số Doppler</legend> <div class="form-grid-col-4"> <div class="form-group"><label for="ua_pi">Umbilical Artery PI / PI ĐM Rốn:</label><input type="number" step="0.01" id="ua_pi" name="uaPi"></div> <div class="form-group"><label for="ua_ri">Umbilical Artery RI / RI ĐM Rốn:</label><input type="number" step="0.01" id="ua_ri" name="uaRi"></div> <div class="form-group"><label for="ua_sd">Umbilical Artery S/D / S/D ĐM Rốn:</label><input type="number" step="0.01" id="ua_sd" name="uaSd"></div> <div class="form-group"><label for="ua_edf">UA End Diastolic Flow / Dòng cuối tâm trương ĐM Rốn:</label><select id="ua_edf" name="uaEdf"><option value="">--Select--</option><option value="Present / Có">Present</option><option value="Absent / Mất">Absent</option><option value="Reversed / Đảo ngược">Reversed</option></select></div> <div class="form-group"><label for="mca_pi">MCA PI / PI ĐM Não giữa:</label><input type="number" step="0.01" id="mca_pi" name="mcaPi"></div> <div class="form-group"><label for="mca_ri">MCA RI / RI ĐM Não giữa:</label><input type="number" step="0.01" id="mca_ri" name="mcaRi"></div> <div class="form-group"><label for="mca_psv">MCA PSV (cm/s) / PSV ĐM Não giữa:</label><input type="number" step="0.1" id="mca_psv" name="mcaPsv"></div> <div class="form-group"><label for="cpr">CPR (MCA PI / UA PI) / Tỷ lệ Não-Rốn:</label><input type="number" step="0.01" id="cpr" name="cpr" class="calculated-value" readonly></div> </div> </fieldset> </div> </details>

                    <details class="section organ-section" open> <summary class="section-toggle"><h3><i class="fas fa-file-medical-alt"></i> Impression & Recommendation / Kết luận & Đề nghị</h3></summary> <div class="section-content"> <div class="form-group"> <label for="impression">Impression / Kết luận:</label> <textarea id="impression" name="impression" rows="5" placeholder="Summarize key findings..."></textarea> <div class="suggestion-button-container"> <button type="button" class="suggestion-btn" data-insert="Single live intrauterine pregnancy at [X]w[Y]d by LMP / Một thai sống trong tử cung [X] tuần [Y] ngày theo KCC.">SLIUP by LMP</button> <button type="button" class="suggestion-btn" data-insert="Single live intrauterine pregnancy at [X]w[Y]d by Ultrasound ([CRL/Biometry]) / Một thai sống trong tử cung [X] tuần [Y] ngày theo Siêu âm ([CRL/Sinh trắc]).">SLIUP by US</button> <button type="button" class="suggestion-btn" data-insert="Fetal biometry consistent with gestational age. / Sinh trắc học thai phù hợp tuổi thai.">Biometry Consistent</button> <button type="button" class="suggestion-btn" data-insert="Estimated fetal weight (EFW) is [X]g, corresponding to the [Y]th percentile for gestational age. / Ước lượng cân nặng thai (ULCN) là [X]g, tương ứng bách phân vị thứ [Y] theo tuổi thai.">EFW Percentile</button> <button type="button" class="suggestion-btn" data-insert="Anatomy survey appears grossly normal for gestational age. / Khảo sát hình thái thai đại thể bình thường theo tuổi thai.">Normal Anatomy</button> <button type="button" class="suggestion-btn" data-insert="Findings suggestive of fetal growth restriction (FGR). / Các dấu hiệu gợi ý thai chậm tăng trưởng trong tử cung (FGR).">Suspected FGR</button> <button type="button" class="suggestion-btn" data-insert="[Specify anomaly] noted. / Ghi nhận [Bất thường cụ thể].">Specify Anomaly</button> <button type="button" class="suggestion-btn" data-insert="Amniotic fluid index (AFI) is normal. / Chỉ số ối (AFI) bình thường.">Normal AFI</button> <button type="button" class="suggestion-btn" data-insert="Oligohydramnios / Thiểu ối (AFI = [X] cm).">Oligohydramnios</button> <button type="button" class="suggestion-btn" data-insert="Polyhydramnios / Đa ối (AFI = [X] cm).">Polyhydramnios</button> <button type="button" class="suggestion-btn" data-insert="Complete placenta previa. / Nhau tiền đạo trung tâm hoàn toàn.">Complete Previa</button> <button type="button" class="suggestion-btn" data-insert="Low-lying placenta, edge [X] mm from internal os. / Nhau bám thấp, mép bánh nhau cách lỗ trong CTC [X] mm.">Low Lying Placenta</button> <button type="button" class="suggestion-btn" data-insert="Short cervix ([X] mm). / Cổ tử cung ngắn ([X] mm).">Short Cervix</button> </div> </div> <div class="form-group"> <label for="recommendation">Recommendation / Đề nghị:</label> <textarea id="recommendation" name="recommendation" rows="3" placeholder="e.g., Routine follow-up, Repeat scan..."></textarea> <div class="suggestion-button-container"> <button type="button" class="suggestion-btn" data-insert="Routine obstetric follow-up. / Tái khám sản định kỳ.">Routine Follow-up</button> <button type="button" class="suggestion-btn" data-insert="Recommend follow-up ultrasound for growth assessment in [2-4] weeks. / Đề nghị siêu âm theo dõi tăng trưởng sau [2-4] tuần.">Follow-up Growth Scan</button> <button type="button" class="suggestion-btn" data-insert="Recommend follow-up ultrasound to reassess [placenta/cervix/fluid] in [X] weeks. / Đề nghị siêu âm đánh giá lại [nhau thai/cổ tử cung/nước ối] sau [X] tuần.">Follow-up Reassess</button> <button type="button" class="suggestion-btn" data-insert="Recommend detailed fetal anomaly scan. / Đề nghị siêu âm khảo sát hình thái học chi tiết.">Detailed Anatomy Scan</button> <button type="button" class="suggestion-btn" data-insert="Recommend fetal echocardiogram. / Đề nghị siêu âm tim thai.">Fetal Echo</button> <button type="button" class="suggestion-btn" data-insert="Recommend Biophysical Profile (BPP) / Doppler assessment. / Đề nghị làm trắc đồ sinh vật lý (BPP) / Doppler.">Recommend BPP/Doppler</button> <button type="button" class="suggestion-btn" data-insert="Recommend genetic counseling. / Đề nghị tư vấn di truyền.">Genetic Counseling</button> <button type="button" class="suggestion-btn" data-insert="Clinical correlation recommended. / Đề nghị tương quan lâm sàng.">Clinical Correlation</button> </div> </div> </div> </details>

                </form>
            </div> <div class="tab-content" id="images">
                <h2>Ultrasound Images / Hình ảnh Siêu âm</h2>

                <div id="video-capture-area">
                    <h4><i class="fas fa-video"></i> Live Capture / Chụp ảnh Trực tiếp</h4>
                    <div id="video-capture-controls">
                        <div class="form-group">
                            <label for="video-source-select">Nguồn Video:</label>
                            <select id="video-source-select">
                                <option value="">-- Vui lòng chọn --</option>
                            </select>
                            <button type="button" id="start-preview-btn" class="small-btn"><i class="fas fa-play"></i> Bắt đầu / Chọn</button>
                        </div>
                    </div>
                    <video id="live-video-feed" playsinline muted style="display: none; max-width: 100%; height: auto;"></video>
                    <button type="button" id="capture-frame-btn" disabled><i class="fas fa-camera"></i> Chụp Khung hình Hiện tại</button>
                    <canvas id="capture-canvas" style="display:none;"></canvas>
                 </div>
                <hr>
                 <div class="form-group">
                    <label for="image-upload">Upload Images / Tải ảnh lên (từ file):</label>
                     <input type="file" id="image-upload" multiple accept="image/*" style="display: block; margin-top: 5px;">
                </div>

                <h4><i class="fas fa-images"></i> Uploaded / Captured Images / Ảnh đã Tải lên / Chụp</h4>
                <div id="image-preview-container" style="margin-top: 15px;">
                    </div>
            </div> <div class="tab-content" id="templates">
                 <h2>Template Management / Quản lý Mẫu</h2>
                <div class="form-group">
                    <label for="template-name">Template Name / Tên Mẫu:</label>
                    <input type="text" id="template-name" placeholder="Enter name to save / Nhập tên để lưu">
                    <button type="button" id="save-template-btn"><i class="fas fa-save"></i> Save Current as Template / Lưu thành Mẫu</button>
                </div>
                <hr>
                <div class="form-group">
                    <label for="load-template-select">Select Template to Load / Chọn Mẫu để tải:</label>
                    <select id="load-template-select">
                        <option value="">-- Select Template / Chọn Mẫu --</option>
                        <optgroup label="Presets / Mẫu có sẵn" id="preset-templates-group"></optgroup>
                        <optgroup label="My Templates / Mẫu của tôi" id="user-templates-group"></optgroup>
                    </select>
                    <button type="button" id="load-template-btn"><i class="fas fa-download"></i> Load Template / Tải Mẫu</button>
                    <button type="button" id="delete-template-btn" class="danger-btn"><i class="fas fa-trash-alt"></i> Delete Selected Template / Xóa Mẫu</button>
                </div>
                <hr>
                <div class="form-group">
                    <label for="import-template-file">Import Template (JSON) / Nhập Mẫu (JSON):</label>
                    <input type="file" id="import-template-file" accept=".json" style="display: none;"> <button type="button" id="import-template-btn"><i class="fas fa-file-import"></i> Import / Nhập</button>
                </div>
                <div class="form-group">
                    <label>Export Current State / Xuất trạng thái hiện tại:</label>
                    <button type="button" id="export-template-btn"><i class="fas fa-file-export"></i> Export Current State (JSON) / Xuất (JSON)</button>
                </div>
            </div> <div class="tab-content" id="report">
                 <h2>Report Preview & Actions / Xem trước & Thao tác Báo cáo</h2>
                <div id="report-preview" class="report-output-area">
                    <p class="placeholder-text"><i>Report preview (EN) will appear here after generation. / Bản xem trước (EN) sẽ hiện ở đây sau khi tạo.</i></p>
                </div>
                <div class="report-section-container" id="translation-section" style="margin-top: 20px; display: none;">
                    <div class="report-header">
                        <h3><i class="fas fa-language"></i> Vietnamese Translation / Bản dịch Tiếng Việt (VI)</h3>
                        <button type="button" id="edit-translation-btn" class="edit-toggle-btn" style="display: none;"><i class="fas fa-edit"></i> Sửa bản dịch</button>
                    </div>
                    <div id="translation-content" class="report-output-area" style="border-top: 1px solid #ddd; border-radius: 0 0 5px 5px; min-height: 100px;">
                        <p class="placeholder-text"><i>Translation (VI) will appear here. / Bản dịch (VI) sẽ hiện ở đây.</i></p>
                    </div>
                    <textarea id="translation-edit-area" class="report-textarea" rows="15" style="display: none; border-radius: 0 0 5px 5px; border-top: 1px solid #ddd; margin-top: -1px;" placeholder="Edit the Markdown translation here... / Chỉnh sửa bản dịch dạng Markdown tại đây..."></textarea>
                 </div>
                <div id="translation-loading" style="text-align: center; margin-top: 15px; display: none;">
                    <span class="loading-spinner"></span> Translating report... / Đang dịch báo cáo...
                </div>
                <div class="report-actions">
                    <button type="button" id="generate-report-btn"><i class="fas fa-cogs"></i> Generate Report / Tạo Báo cáo</button>
                    <button type="button" id="translate-report-btn" style="display: none;" class="action-btn-translate"><i class="fas fa-language"></i> Dịch (VI)</button>
                    <button type="button" id="print-report-btn" style="display: none;"><i class="fas fa-print"></i> Print / In (EN)</button>
                    <button type="button" id="print-translation-btn" style="display: none;" class="action-btn-print-vi"><i class="fas fa-print"></i> Print / In (VI)</button>
                    <button type="button" id="export-report-html-btn" style="display: none;"><i class="fas fa-file-export"></i> Export / Xuất (HTML)</button>
                </div>
            </div> </div> <div id="notifications"></div>

    </div> <script type="module" src="js/main.js"></script>
</body>
</html>